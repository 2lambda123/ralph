FROM ubuntu:bionic
MAINTAINER PyLabs pylabs@allegro.pl

# set UTF-8 locale
RUN apt-get clean && apt-get update
RUN apt-get install locales
RUN locale-gen en_US.UTF-8
ENV LANG en_US.UTF-8
ENV LANGUAGE en_US:en
ENV LC_ALL en_US.UTF-8

RUN apt-get update && apt-get -y install apt-transport-https gnupg2 ca-certificates
RUN apt-key adv --keyserver  hkp://keyserver.ubuntu.com:80 --recv-keys 379CE192D401AB61
RUN sh -c "echo 'deb https://dl.bintray.com/vi4m/ralph wheezy main' >  /etc/apt/sources.list.d/vi4m_ralph.list"

RUN apt-get update
# TODO: change this after uploading new image to ppa/bintray
#RUN apt-get -y install ralph-core
RUN apt-get -y install python3 python3-dev libmysqlclient-dev
COPY ralph-core_3.0.0-31_amd64.deb /tmp
RUN dpkg -i /tmp/ralph-core_3.0.0-31_amd64.deb
RUN apt-get -f install

ENV DATABASE_NAME=ralph_ng
ENV DATABASE_USER=ralph_ng
ENV DATABASE_PASSWORD=ralph_ng
ENV DATABASE_HOST=127.0.0.1
ENV DATABASE_PORT=33074
ENV PATH=/opt/ralph/ralph-core/bin/:$PATH
ENV RALPH_DEBUG=1
